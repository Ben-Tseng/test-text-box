javascript:(()=>{(0,eval)(atob("LyoqCiAqIFVzYWdlOgogKiAxKSBPcGVuIHRhcmdldCBwYWdlCiAqIDIpIE9wZW4gRGV2VG9vbHMgQ29uc29sZQogKiAzKSBQYXN0ZSB0aGlzIGZpbGUgY29udGVudCBhbmQgcnVuCiAqLwooYXN5bmMgKCkgPT4gewogIGNvbnN0IFRBUkdFVF9GSUVMRCA9ICJtY2lkX3ByaW1hcnlfZGVjcnlwdGVkIGVxdWFscyI7CiAgY29uc3QgRVhBQ1RfTUVOVV9CVVRUT05fU0VMRUNUT1IgPSBbCiAgICAnYnV0dG9uW2RhdGEtYXV0b21hdGlvbi1pZD0ic2hlZXQgY29udHJvbCBtZW51IGJ1dHRvbiJdW2RhdGEtYXV0b21hdGlvbi1jb250ZXh0PSJtY2lkX3ByaW1hcnlfZGVjcnlwdGVkIGVxdWFscyJdJywKICAgICdidXR0b25bZGF0YS1hdXRvbWF0aW9uLWlkPSJzaGVldC5jb250cm9sLm1lbnUuYnV0dG9uIl1bZGF0YS1hdXRvbWF0aW9uLWNvbnRleHQ9Im1jaWRfcHJpbWFyeV9kZWNyeXB0ZWQgZXF1YWxzIl0nLAogICAgJ2J1dHRvbltkYXRhLWF1dG9tYXRpb24taWQ9InNoZWV0IGNvbnRyb2wgbWVudWJ1dHRvbiJdW2RhdGEtYXV0b21hdGlvbi1jb250ZXh0PSJtY2lkX3ByaW1hcnlfZGVjcnlwdGVkIGVxdWFscyJdJywKICBdLmpvaW4oIiwgIik7CgogIGNvbnN0IHNsZWVwID0gKG1zKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpOwogIGNvbnN0IG5vcm0gPSAocykgPT4gKHMgfHwgIiIpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW1xzLl8tXSsvZywgIiIpOwoKICBmdW5jdGlvbiBpc1Zpc2libGUoZWwpIHsKICAgIGlmICghZWwpIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGNvbnN0IHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpOwogICAgcmV0dXJuIHJlY3Qud2lkdGggPiAwICYmIHJlY3QuaGVpZ2h0ID4gMCAmJiBzdHlsZS52aXNpYmlsaXR5ICE9PSAiaGlkZGVuIiAmJiBzdHlsZS5kaXNwbGF5ICE9PSAibm9uZSI7CiAgfQoKICBmdW5jdGlvbiBjb2xsZWN0Um9vdHMoc3RhcnREb2N1bWVudCkgewogICAgY29uc3Qgcm9vdHMgPSBbc3RhcnREb2N1bWVudF07CiAgICBmb3IgKGNvbnN0IGZyYW1lIG9mIHN0YXJ0RG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiaWZyYW1lIikpIHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAoZnJhbWUuY29udGVudERvY3VtZW50KSByb290cy5wdXNoKC4uLmNvbGxlY3RSb290cyhmcmFtZS5jb250ZW50RG9jdW1lbnQpKTsKICAgICAgfSBjYXRjaCAoXykgewogICAgICAgIC8vIENyb3NzLW9yaWdpbiBpZnJhbWU7IHNraXAuCiAgICAgIH0KICAgIH0KICAgIHJldHVybiByb290czsKICB9CgogIGZ1bmN0aW9uIGNvbGxlY3RJbnRlcmFjdGl2ZUNhbmRpZGF0ZXMocm9vdCkgewogICAgY29uc3QgcmVzdWx0ID0gW107CiAgICBjb25zdCB3YWxrID0gKG5vZGVSb290KSA9PiB7CiAgICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSBub2RlUm9vdC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24sIFtyb2xlPSJidXR0b24iXSwgW2FyaWEtaGFzcG9wdXA9InRydWUiXSwgW3JvbGU9Im1lbnVpdGVtIl0sIGxpW3JvbGU9Im1lbnVpdGVtIl0nKTsKICAgICAgZm9yIChjb25zdCBlbCBvZiBjYW5kaWRhdGVzKSByZXN1bHQucHVzaChlbCk7CiAgICAgIGNvbnN0IGFsbCA9IG5vZGVSb290LnF1ZXJ5U2VsZWN0b3JBbGwoIioiKTsKICAgICAgZm9yIChjb25zdCBlbCBvZiBhbGwpIHsKICAgICAgICBpZiAoZWwuc2hhZG93Um9vdCkgd2FsayhlbC5zaGFkb3dSb290KTsKICAgICAgfQogICAgfTsKICAgIHdhbGsocm9vdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgZnVuY3Rpb24gb3BlbldpdGhNb3VzZVNlcXVlbmNlKGVsKSB7CiAgICBjb25zdCBldmVudHMgPSBbInBvaW50ZXJkb3duIiwgIm1vdXNlZG93biIsICJwb2ludGVydXAiLCAibW91c2V1cCIsICJjbGljayJdOwogICAgZm9yIChjb25zdCB0eXBlIG9mIGV2ZW50cykgewogICAgICBlbC5kaXNwYXRjaEV2ZW50KG5ldyBNb3VzZUV2ZW50KHR5cGUsIHsgYnViYmxlczogdHJ1ZSwgY2FuY2VsYWJsZTogdHJ1ZSwgdmlldzogd2luZG93IH0pKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNjb3JlTWVudUJ1dHRvbihlbCkgewogICAgY29uc3QgYXR0cnMgPSBbCiAgICAgIGVsLmdldEF0dHJpYnV0ZSgiZGF0YS1hdXRvbWF0aW9uLWlkIiksCiAgICAgIGVsLmdldEF0dHJpYnV0ZSgiZGF0YS1hdXRvbWF0aW9uLWNvbnRleHQiKSwKICAgICAgZWwuZ2V0QXR0cmlidXRlKCJhcmlhLWxhYmVsIiksCiAgICAgIGVsLmdldEF0dHJpYnV0ZSgidGl0bGUiKSwKICAgICAgZWwudGV4dENvbnRlbnQsCiAgICBdCiAgICAgIC5maWx0ZXIoQm9vbGVhbikKICAgICAgLmpvaW4oIiAiKTsKICAgIGNvbnN0IG4gPSBub3JtKGF0dHJzKTsKICAgIGNvbnN0IGZpZWxkID0gbm9ybShUQVJHRVRfRklFTEQpOwogICAgbGV0IHNjb3JlID0gMDsKICAgIGlmIChuLmluY2x1ZGVzKCJzaGVldGNvbnRyb2xtZW51YnV0dG9uIikpIHNjb3JlICs9IDU7CiAgICBpZiAobi5pbmNsdWRlcygib3B0aW9ucyIpKSBzY29yZSArPSAzOwogICAgaWYgKG4uaW5jbHVkZXMoZmllbGQpKSBzY29yZSArPSA0OwogICAgaWYgKG4uaW5jbHVkZXMoIm1jaWRwcmltYXJ5ZGVjcnlwdGVkZXF1YWxzIikpIHNjb3JlICs9IDQ7CiAgICBpZiAoKGVsLmdldEF0dHJpYnV0ZSgiYXJpYS1oYXNwb3B1cCIpIHx8ICIiKS50b0xvd2VyQ2FzZSgpID09PSAidHJ1ZSIpIHNjb3JlICs9IDE7CiAgICBpZiAoZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiYnV0dG9uIikgc2NvcmUgKz0gMTsKICAgIGlmICghaXNWaXNpYmxlKGVsKSkgc2NvcmUgLT0gMTAwOwogICAgcmV0dXJuIHNjb3JlOwogIH0KCiAgZnVuY3Rpb24gZGVzY3JpYmVFbGVtZW50KGVsKSB7CiAgICBpZiAoIWVsKSByZXR1cm4gIiI7CiAgICBjb25zdCBwYXJ0cyA9IFsKICAgICAgZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpLAogICAgICBlbC5nZXRBdHRyaWJ1dGUoImRhdGEtYXV0b21hdGlvbi1pZCIpIHx8ICIiLAogICAgICBlbC5nZXRBdHRyaWJ1dGUoImRhdGEtYXV0b21hdGlvbi1jb250ZXh0IikgfHwgIiIsCiAgICAgIGVsLmdldEF0dHJpYnV0ZSgiYXJpYS1sYWJlbCIpIHx8ICIiLAogICAgICBlbC5nZXRBdHRyaWJ1dGUoInRpdGxlIikgfHwgIiIsCiAgICAgIChlbC50ZXh0Q29udGVudCB8fCAiIikudHJpbSgpLnNsaWNlKDAsIDYwKSwKICAgIF0uZmlsdGVyKEJvb2xlYW4pOwogICAgcmV0dXJuIHBhcnRzLmpvaW4oIiB8ICIpOwogIH0KCiAgZnVuY3Rpb24gZmluZEJlc3RNZW51QnV0dG9uKCkgewogICAgY29uc3Qgcm9vdHMgPSBjb2xsZWN0Um9vdHMoZG9jdW1lbnQpOwogICAgZm9yIChjb25zdCByb290IG9mIHJvb3RzKSB7CiAgICAgIGNvbnN0IGV4YWN0ID0gcm9vdC5xdWVyeVNlbGVjdG9yKEVYQUNUX01FTlVfQlVUVE9OX1NFTEVDVE9SKTsKICAgICAgaWYgKGV4YWN0ICYmIGlzVmlzaWJsZShleGFjdCkpIHJldHVybiBleGFjdDsKICAgIH0KCiAgICBsZXQgYmVzdCA9IG51bGw7CiAgICBsZXQgYmVzdFNjb3JlID0gLUluZmluaXR5OwogICAgZm9yIChjb25zdCByb290IG9mIHJvb3RzKSB7CiAgICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSBjb2xsZWN0SW50ZXJhY3RpdmVDYW5kaWRhdGVzKHJvb3QpOwogICAgICBmb3IgKGNvbnN0IGVsIG9mIGNhbmRpZGF0ZXMpIHsKICAgICAgICBjb25zdCBzY29yZSA9IHNjb3JlTWVudUJ1dHRvbihlbCk7CiAgICAgICAgaWYgKHNjb3JlID4gYmVzdFNjb3JlKSB7CiAgICAgICAgICBiZXN0ID0gZWw7CiAgICAgICAgICBiZXN0U2NvcmUgPSBzY29yZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBiZXN0U2NvcmUgPj0gNCA/IGJlc3QgOiBudWxsOwogIH0KCiAgYXN5bmMgZnVuY3Rpb24gd2FpdEZvck1lbnVCdXR0b24odGltZW91dE1zID0gODAwMCkgewogICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpOwogICAgd2hpbGUgKERhdGUubm93KCkgLSBzdGFydCA8IHRpbWVvdXRNcykgewogICAgICBjb25zdCBlbCA9IGZpbmRCZXN0TWVudUJ1dHRvbigpOwogICAgICBpZiAoZWwpIHJldHVybiBlbDsKICAgICAgYXdhaXQgc2xlZXAoMTAwKTsKICAgIH0KICAgIHJldHVybiBudWxsOwogIH0KCiAgZnVuY3Rpb24gaXNSZXNldEl0ZW0oZWwsIG9wZW5lZE1lbnVzT25seSkgewogICAgaWYgKCFlbCkgcmV0dXJuIGZhbHNlOwogICAgaWYgKCFpc1Zpc2libGUoZWwpKSByZXR1cm4gZmFsc2U7CiAgICBjb25zdCBhdXRvbWF0aW9uSWQgPSBub3JtKGVsLmdldEF0dHJpYnV0ZSgiZGF0YS1hdXRvbWF0aW9uLWlkIikpOwogICAgY29uc3QgdGV4dCA9IG5vcm0oKGVsLnRleHRDb250ZW50IHx8ICIiKS50cmltKCkpOwogICAgaWYgKG9wZW5lZE1lbnVzT25seSkgewogICAgICBjb25zdCBtZW51Q29udGFpbmVyID0gZWwuY2xvc2VzdCgnW3JvbGU9Im1lbnUiXSwgLk11aU1lbnUtcGFwZXIsIC5NdWlQb3BvdmVyLXBhcGVyJyk7CiAgICAgIGlmICghbWVudUNvbnRhaW5lciB8fCAhaXNWaXNpYmxlKG1lbnVDb250YWluZXIpKSByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gYXV0b21hdGlvbklkLmluY2x1ZGVzKCJyZXNldCIpIHx8IHRleHQgPT09ICJyZXNldCIgfHwgdGV4dC5pbmNsdWRlcygicmVzZXQiKTsKICB9CgogIGFzeW5jIGZ1bmN0aW9uIGZpbmRSZXNldEl0ZW0odGltZW91dE1zID0gODAwMCkgewogICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpOwogICAgd2hpbGUgKERhdGUubm93KCkgLSBzdGFydCA8IHRpbWVvdXRNcykgewogICAgICBjb25zdCByb290cyA9IGNvbGxlY3RSb290cyhkb2N1bWVudCk7CiAgICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSBbXTsKICAgICAgZm9yIChjb25zdCByb290IG9mIHJvb3RzKSB7CiAgICAgICAgY2FuZGlkYXRlcy5wdXNoKC4uLmNvbGxlY3RJbnRlcmFjdGl2ZUNhbmRpZGF0ZXMocm9vdCkpOwogICAgICB9CiAgICAgIGNvbnN0IHJlc2V0SW5PcGVuTWVudSA9IGNhbmRpZGF0ZXMuZmluZCgoZWwpID0+IGlzUmVzZXRJdGVtKGVsLCB0cnVlKSk7CiAgICAgIGlmIChyZXNldEluT3Blbk1lbnUpIHJldHVybiByZXNldEluT3Blbk1lbnU7CiAgICAgIGNvbnN0IGFueVJlc2V0ID0gY2FuZGlkYXRlcy5maW5kKChlbCkgPT4gaXNSZXNldEl0ZW0oZWwsIGZhbHNlKSk7CiAgICAgIGlmIChhbnlSZXNldCkgcmV0dXJuIGFueVJlc2V0OwogICAgICBhd2FpdCBzbGVlcCgxMDApOwogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBtZW51QnV0dG9uID0gYXdhaXQgd2FpdEZvck1lbnVCdXR0b24oMTAwMDApOwogIGlmICghbWVudUJ1dHRvbikgewogICAgY29uc3Qgcm9vdHMgPSBjb2xsZWN0Um9vdHMoZG9jdW1lbnQpOwogICAgY29uc3Qgc2NvcmVkID0gW107CiAgICBmb3IgKGNvbnN0IHJvb3Qgb2Ygcm9vdHMpIHsKICAgICAgZm9yIChjb25zdCBlbCBvZiBjb2xsZWN0SW50ZXJhY3RpdmVDYW5kaWRhdGVzKHJvb3QpKSB7CiAgICAgICAgY29uc3Qgc2NvcmUgPSBzY29yZU1lbnVCdXR0b24oZWwpOwogICAgICAgIGlmIChzY29yZSA+IC01MCkgc2NvcmVkLnB1c2goeyBzY29yZSwgZGVzYzogZGVzY3JpYmVFbGVtZW50KGVsKSB9KTsKICAgICAgfQogICAgfQogICAgc2NvcmVkLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKTsKICAgIGNvbnNvbGUubG9nKCLlgJnpgInmjInpkq4o5YmNMTApOiIsIHNjb3JlZC5zbGljZSgwLCAxMCkpOwogICAgdGhyb3cgbmV3IEVycm9yKCLmib7kuI3liLDkuInngrnoj5zljZXmjInpkq7jgILor7fnoa7orqTlrZfmrrXlkI3mmK/lkKbkuLogbWNpZF9wcmltYXJ5X2RlY3J5cHRlZCBlcXVhbHPvvIzmiJbor6XmjInpkq7mmK/lkKblnKjot6jln58gaWZyYW1lIOWGheOAgiIpOwogIH0KCiAgb3BlbldpdGhNb3VzZVNlcXVlbmNlKG1lbnVCdXR0b24pOwoKICAvLyBXYWl0IGZvciBtZW51IHJlbmRlci4KICBhd2FpdCBzbGVlcCgyNTApOwogIGNvbnN0IHJlc2V0SXRlbSA9IGF3YWl0IGZpbmRSZXNldEl0ZW0oODAwMCk7CgogIGlmICghcmVzZXRJdGVtKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIueCueWHu+S6huS4ieeCueiPnOWNle+8jOS9huayoeaJvuWIsCBSZXNldCDpgInpobnjgIIiKTsKICB9CgogIHJlc2V0SXRlbS5jbGljaygpOwogIGNvbnNvbGUubG9nKCLlt7LlrozmiJDvvJrngrnlh7vkuInngrnoj5zljZXlubbpgInmi6kgUmVzZXTjgIIiKTsKfSkoKTsK"));})();